{% extends 'home.html' %}
{% block home %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/agents.css' %}">

    <main class="main-contents">
        <!-- <header class="header">
            <div class="breadcrumb">
                <a href="#dashboard">Dashboard</a> / PO Lookup Agent
            </div>
            <h2>🔎 Purchase Order Lookup Assistant</h2>
        </header> -->

        <div class="lookup-container">
            <div class="form-section">
                <h3 class="form-title">Get PO Details</h3>
                <form method="post" action="{% url 'getpo_agent' %}" id="poForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <!-- <label for="po_number" class="form-label">Enter PO Number:</label> -->
                        <input 
                            type="text" 
                            id="po_number" 
                            name="po_number" 
                            class="form-input"
                            
                            placeholder="Enter PO Number"
                            required
                        >
                    </div>
                    <button type="submit" class="btn btn-primary mt-2">
                        🔍 Fetch Details
                    </button>
                </form>
            </div>

            <div class="loading" id="loading">
                <p>🔄 Searching for PO details...</p>
            </div>
        </div>

        {% if result %}
        <div class="result-container">
            <div class="result-header">
                <h3 class="result-title">Results for PO: {{ submitted_po }}</h3>
                <div class="status-badge {% if result.status == 'success' %}status-success{% else %}status-error{% endif %}">
                    {% if result.status == 'success' %}
                        ✅ Success
                    {% else %}
                        ❌ Error
                    {% endif %}
                </div>
            </div>
            <div class="result-content">
                {% if result.status == 'success' %}
                    <div class="data-section">
                        <h4 class="data-title">PO Header Data</h4>
                        <div class="data-display">{{ result.po_header | pprint }}</div>
                    </div>
                {% else %}
                    <div class="error-message">
                        <strong>Message:</strong> {{ result.message }}
                    </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </main>

    <script>
        // Show loading when form is submitted
        document.getElementById('poForm').addEventListener('submit', function() {
            document.getElementById('loading').classList.add('show');
        });
    </script>

{% endblock %}